# CHANGELOG

## 2026-02-05
- Split SMTP auth user from From address to support SendGrid; added config validation for missing SMTP_FROM; added WEB_APP_URL-based reset link. (evidence: api/src/lib/emailService.js; api/src/functions/auth.js)
- Improved forgot-password email template with branded HTML, plain-text fallback, and 24h expiry note. (evidence: api/src/functions/auth.js)
- Enforced WEB_APP_URL requirement in production to avoid localhost reset links; documented SMTP/WEB_APP_URL envs. (evidence: api/src/functions/auth.js; docs/ENVIRONMENT.md)
- Restyled reset password page to match branded auth layout with illustration and CTA. (evidence: web/src/pages/ResetPasswordPage/ResetPasswordPage.jsx)
- Added optional welcome email after signup, gated by WELCOME_EMAIL_ENABLED flag. (evidence: api/src/functions/auth.js; api/src/lib/emailService.js; docs/ENVIRONMENT.md)
- Created root `.env` with required DB URL, session secret, SMTP placeholders, and seed defaults to match ENVIRONMENT.md guidance for local development. (evidence: .env, docs/ENVIRONMENT.md)

## 2026-02-04
- Added JSON-driven seed flow importing users, projects, allocations, meetings, and daily updates with sequence resets and configurable seeded-user password. (evidence: scripts/seed.js, scripts/seed_data_2creative.json)
- `yarn rw build` initially failed due to missing `@2c/pd-root` in lockfile; resolved with `yarn install` and build now passes. (evidence: docs/TECHNICAL_CHALLENGES.md)
- Fixed `activeProjects` service filter to match Title Case status values so seeded projects appear in Project Tracker. (evidence: api/src/services/projects/projects.js)
- Normalized allocation status checks in Project Management/Employee Management so active projects and hours/day display correctly. (evidence: api/src/services/projectAllocations/projectAllocations.js; web/src/components/ProjectTracker/EmployeeManagement.jsx)
- Seed now assigns a default `hoursAllocated` (8h) when JSON allocations omit hours, keeping hours/day from showing 0. (evidence: scripts/seed.js)
- Added historical attendance (past year workdays), vacations, and exception requests for all seeded users. (evidence: scripts/seed.js; yarn rw prisma db seed)
- Attendance, vacation, and exception seeds now clear existing rows before insert to prevent duplication on re-seed. (evidence: scripts/seed.js)
- Status values are normalized on seed, and project/allocation queries now compare case-insensitively to avoid casing drift in data. (evidence: scripts/seed.js; api/src/services/projects/projects.js; api/src/services/projectAllocations/projectAllocations.js)

## 2026-01-30
- Removed unused Capacitor dependencies and references. (evidence: package.json, web/package.json, yarn.lock, docs/PROJECT_NOTES.md)
- Added instruction to avoid unsolicited dependency warning commentary. (evidence: AGENTS.md)
- Added optional default admin seed with env overrides for first-run setup. (evidence: scripts/seed.js, docs/ENVIRONMENT.md, docs/GETTING_STARTED.md)
- Fixed office supplies seed to use current SupplyRequest fields. (evidence: scripts/seedOfficeSupplies.js)
- Highlighted default admin seed log output. (evidence: scripts/seed.js)
- Added divider lines around admin seed log output. (evidence: scripts/seed.js)
- Removed unused variable in asset seed loop. (evidence: scripts/seed.js)
- Added blank lines between seed sections for readability. (evidence: scripts/seed.js, scripts/seedOfficeSupplies.js)
- Upgraded Tailwind to v4.1 with Vite plugin and updated CSS import; removed PostCSS/autoprefixer. (evidence: web/package.json, web/vite.config.js, web/src/index.css)
- Added Tailwind v4 reference directive and fixed scaffold scrollbar color; removed Tailwind config from Prettier. (evidence: web/src/scaffold.css, prettier.config.js)
- Fixed AdminPanelPage to import gql for runtime queries. (evidence: web/src/pages/AdminPanelPage/AdminPanelPage.jsx)
- Removed unused browserslist from web/package.json. (evidence: web/package.json)
- Updated user dropdown to show full name and email. (evidence: web/src/components/Header/Header.jsx)
- Left-aligned main nav and removed button-like styles. (evidence: web/src/components/Header/Header.jsx)
- Simplified mobile nav styling to plain list with separators. (evidence: web/src/components/Header/Header.jsx)
- Mobile nav now fills viewport height with root padding 4. (evidence: web/src/components/Header/Header.jsx)
- Increased mobile nav item padding for readability. (evidence: web/src/components/Header/Header.jsx)
- Reverted padding increase for nested resource items. (evidence: web/src/components/Header/Header.jsx)
- Added right chevron icon before nested resource text. (evidence: web/src/components/Header/Header.jsx)
- Added Remixicon npm package and local stylesheet import for ri-* icons. (evidence: web/package.json, web/src/index.css)
- Moved react-icons dependency from root to web workspace. (evidence: package.json, web/package.json, yarn.lock)
- Redesigned login page layout with reusable brand styles and illustration. (evidence: web/src/pages/LoginPage/LoginPage.jsx, web/src/styles/brand-nxa.css, web/public/login-illustration.svg)
- Applied NXA auth styling to signup/forgot pages and added normal-case auth error styling. (evidence: web/src/pages/SignupPage/SignupPage.jsx, web/src/pages/ForgotPasswordPage/ForgotPasswordPage.jsx, web/src/styles/brand-nxa.css)
- Added reusable NXA link styling with dashed hover treatment for auth links. (evidence: web/src/styles/brand-nxa.css, web/src/pages/LoginPage/LoginPage.jsx, web/src/pages/SignupPage/SignupPage.jsx, web/src/pages/ForgotPasswordPage/ForgotPasswordPage.jsx)
- Replaced auth illustration with auth-banner.webp and removed legacy SVG. (evidence: web/src/pages/LoginPage/LoginPage.jsx, web/src/pages/SignupPage/SignupPage.jsx, web/src/pages/ForgotPasswordPage/ForgotPasswordPage.jsx, web/public/auth-banner.webp)
- Updated auth illustration to fill the entire panel with object-cover. (evidence: web/src/styles/brand-nxa.css)
- Prevented layout shift on NXA links by reserving the hover underline space. (evidence: web/src/styles/brand-nxa.css)
- Restored inline login validation errors using the NXA error style. (evidence: web/src/pages/LoginPage/LoginPage.jsx)
- Refined auth error styling with tighter spacing and darker normal-weight red. (evidence: web/src/styles/brand-nxa.css)
- Normalized auth routes to `/signin` and `/signup`, keeping legacy reset/forgot paths. (evidence: web/src/Routes.jsx)
- Wired “Remember me” to store and restore the sign-in email locally. (evidence: web/src/pages/LoginPage/LoginPage.jsx)
- Updated remember-email storage key to `@2CPD/auth_email` using a shared prefix constant. (evidence: web/src/pages/LoginPage/LoginPage.jsx)
- Centralized localStorage key prefixing in a shared storage keys helper. (evidence: web/src/lib/storageKeys.js, web/src/pages/LoginPage/LoginPage.jsx)
- Made the sign-in email field controlled so remembered email appears reliably. (evidence: web/src/pages/LoginPage/LoginPage.jsx)

## 2026-01-28
- Standard seed now also runs office supplies seeding. (evidence: scripts/seed.js)
- Documented warning that office supplies seeding clears existing data. (evidence: docs/GETTING_STARTED.md)
- Installed Yarn 4.6.0 via Corepack and `yarn rw build` now passes. (evidence: docs/TECHNICAL_CHALLENGES.md)
- DbAuth audit: fixed signup username field + forgot-password email handling; verified DbAuth provider usage. (evidence: web/src/pages/SignupPage/SignupPage.jsx, web/src/pages/ForgotPasswordPage/ForgotPasswordPage.jsx, web/src/auth.js)
- Added feature inventory with evidence links to plan. (evidence: docs/PLAN.md)
- Validated Prisma migrations align with current schema; no drift noted. (evidence: api/db/schema.prisma, api/db/migrations)
- Reviewed role gating: Private routes and admin routes wired to DbAuth roles; services enforce auth/ADMIN where needed. (evidence: web/src/Routes.jsx; api/src/services/officeSupplies/officeSupplies.js; api/src/services/officeSupplyCategories/officeSupplyCategories.js; api/src/services/assetAssignments/assetAssignments.js; api/src/lib/auth.js)
- Verified office supplies workflows end-to-end: routes align with services and schema; admin gating enforced; supply requests approval flow checked. (evidence: web/src/Routes.jsx; api/src/services/officeSupplies/officeSupplies.js; api/src/services/officeSupplyCategories/officeSupplyCategories.js; api/src/services/supplyRequests/supplyRequests.js; api/db/schema.prisma)
- Verified asset tracker workflows end-to-end: routes/pages align with services and Prisma schema; asset assignments and requests enforce auth/ADMIN where needed. (evidence: web/src/pages/AssetTrackerPage/AssetTrackerPage.jsx; api/src/services/assets/assets.js; api/src/services/assetCategories/assetCategories.js; api/src/services/assetAssignments/assetAssignments.js; api/src/services/assetRequests/assetRequests.js; api/db/schema.prisma)
- Verified project tracker workflows end-to-end: project tracker page and tabs align with project/allocations/meetings/daily updates services and Prisma schema; build remains clean. (evidence: web/src/pages/ProjectTrackerPage/ProjectTrackerPage.jsx; web/src/components/ProjectTracker/ProjectTracker.jsx; api/src/services/projects/projects.js; api/src/services/projectAllocations/projectAllocations.js; api/src/services/projectMeetings/projectMeetings.js; api/src/services/dailyProjectUpdates/dailyProjectUpdates.js; api/db/schema.prisma)
- Fixed team allocation deletion error: deleteProjectAllocation now returns pre-delete data and resolvers use parent data, preventing null user GraphQL errors. (evidence: api/src/services/projectAllocations/projectAllocations.js)
- Verified attendance and vacation workflows: dashboard attendance/vacation components align with attendance/overtime/exception/vacation services and Prisma schema; build remains clean. (evidence: web/src/pages/DashboardPage/DashboardPage.jsx; web/src/components/Attendance/Attendance.jsx; web/src/components/VacationPlanner/VacationPlanner.jsx; api/src/services/attendances/attendances.js; api/src/services/attendanceBreaks/attendanceBreaks.js; api/src/services/overtimeAttendances/overtimeAttendances.js; api/src/services/vacationRequests/vacationRequests.js; api/src/services/exceptionRequests/exceptionRequests.js; api/db/schema.prisma)
- Hardened project allocation delete: remove dailyUpdates from the returned payload to avoid resolver errors when deleted child rows are selected. (evidence: api/src/services/projectAllocations/projectAllocations.js)

## 2026-01-27
- Split mixed notes into `docs/PROJECT_NOTES.md` and `docs/REDWOOD_TUTORIAL_NOTES.md`; removed old `REDWOOD_NOTES.md`. (evidence: docs/PROJECT_NOTES.md, docs/REDWOOD_TUTORIAL_NOTES.md)
- Added plan in `docs/PLAN.md` and moved planning stub to `docs/Planning Guide.md`. (evidence: docs/PLAN.md, docs/Planning Guide.md)
- Created tracking docs `docs/PBI-Shekhar.md`, `docs/PBI-Sarath.md`, `docs/CHANGELOG.md`, `docs/EVIDENCE_INDEX.md`, and `docs/WORK_LOG.md`. (evidence: docs/PBI-Shekhar.md, docs/PBI-Sarath.md, docs/CHANGELOG.md, docs/EVIDENCE_INDEX.md, docs/WORK_LOG.md)
- Moved TODOs to `docs/TODO.md` and removed `docs/README.md` (empty). (evidence: docs/TODO.md)
- Removed Supabase/Azure artifacts and dependencies; archived legacy auth checklist. (evidence: package.json, api/package.json, web/package.json, docs/archive/check-auth-config.md)
- Cleaned Supabase/Azure references from config/docs and debug utilities; removed unused auth debug component. (evidence: redwood.toml, docs/PROJECT_NOTES.md, api/src/functions/debug.js, api/src/functions/auth-test.js)
- Added `docs/TECHNICAL_CHALLENGES.md`. (evidence: docs/TECHNICAL_CHALLENGES.md)
- Documented SMTP verification gap for password reset flow. (evidence: docs/TODO.md, docs/TECHNICAL_CHALLENGES.md)
- Verified review flow steps map to existing routes and dashboard components. (evidence: web/src/Routes.jsx, web/src/pages/DashboardPage/DashboardPage.jsx)
- Reworded review references to production/review terminology. (evidence: README.md, docs/PLAN.md, docs/Planning Guide.md, api/src/functions/graphql.js)
- Updated `docs/PLAN.md` to reflect DbAuth-only state and office supplies seed decision. (evidence: docs/PLAN.md)
- Added environment variable reference doc and linked it from README. (evidence: docs/ENVIRONMENT.md, README.md)
- `yarn rw build` failed due to Node 20.x requirement; recorded in technical challenges. (evidence: docs/TECHNICAL_CHALLENGES.md)
- Updated PBI evidence links for PT-005/PT-019. (evidence: docs/PBI-Shekhar.md)
- Split PBIs into owner-specific files. (evidence: docs/PBI-Shekhar.md, docs/PBI-Sarath.md)
- Upgraded Node version references to 25.x and updated RedwoodJS packages to 8.9.0. (evidence: .nvmrc, package.json, api/package.json, web/package.json, netlify.toml, docs/PROJECT_NOTES.md)
- Added getting started guidance for Node 25.x. (evidence: README.md)
- Installed dependencies after version updates (yarn.lock updated). (evidence: yarn.lock)
- `yarn rw dev` failed to determine a free API port; recorded in technical challenges. (evidence: docs/TECHNICAL_CHALLENGES.md)
- Resolved GraphQL codegen errors by renaming duplicate operation names in office supply components. (evidence: web/src/components/OfficeSupply/CategoryManager/CategoryManager.jsx, web/src/components/OfficeSupply/OfficeSupplyForm/OfficeSupplyForm.jsx, web/src/components/OfficeSupply/SupplyInventory/SupplyInventory.jsx, web/src/components/OfficeSupply/SupplyRequestManager/SupplyRequestManager.jsx)
- Replaced missing `checkAvailability` query with meeting room bookings query in booking form. (evidence: web/src/components/Booking/BookingForm/BookingForm.jsx)
- `yarn rw build` succeeded after configuring HOME to a writable cache and allowing Prisma download. (evidence: docs/TECHNICAL_CHALLENGES.md)
- Noted Redwood quick start Node 20.x vs project Node 25.x in docs. (evidence: README.md, docs/PROJECT_NOTES.md, docs/PLAN.md)
- Fixed `yarn rw check` blockers by aligning SDL and env configuration. (evidence: api/src/graphql/bookings.sdl.js, api/src/graphql/supplyRequests.sdl.js, .env.defaults, redwood.toml)
- `yarn rw check` now passes without errors or warnings. (evidence: docs/TECHNICAL_CHALLENGES.md)
- Added new hire setup guide and contributing guide; README now links to them. (evidence: docs/GETTING_STARTED.md, docs/CONTRIBUTING.md, README.md)
- Added `.home/` and `.prisma/` to gitignore. (evidence: .gitignore)
- Fixed test email sender to use centralized SMTP config (FROM_NAME/EMAIL) so multi-domain tests no longer reference undefined `smtpFrom`; `yarn rw build` verified. (evidence: api/src/lib/emailService.js, api/src/lib/smtpConfig.js)
